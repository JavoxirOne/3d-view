<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/lib/three.min.js"></script>
    <title>Document</title>
</head>
<body>
    <!-- <canvas id="canvas"></canvas> -->

<!--    <div class="menu">-->
<!--        <nav class="navbar">-->
<!--            <h1>Javohir Nurmatjonov</h1>-->
<!--        </nav>-->
<!--    </div>-->

    <div class="colors">
        <ul class="colors-group">
            <li>
                <div class="color-1 color" id="color-1"></div>
            </li>
            <li>
                <div class="color-2 color" id="color-2"></div>
            </li>
            <li>
                <div class="color-3 color" id="color-3"></div>
            </li>
            <li>
                <div class="color-4 color" id="color-4"></div>
            </li>
            <li>
                <div class="color-5 color" id="color-5"></div>
            </li>
            <li>
                <div class="color-6 color" id="color-6"></div>
            </li>
            <li>
                <div class="color-7 color" id="color-7"></div>
            </li>
            <li>
                <div class="color-8 color" id="color-8"></div>
            </li>
            <li>
                <div class="color-9 color" id="color-9"></div>
            </li>
        </ul>
    </div>

    <script src="js/lib/GLTFLoader.js"></script>
    <script src="js/lib/OrbitControls.js"></script>
    <script src="js/lib/dat.gui.min.js"></script>
    <!-- <script type="module" src="js/script.js"></script> -->
    
    <script>

        let pkw = "rgb(244, 243, 239)",
            tw3 = "rgb(238, 238, 236)",
            u5s = "rgb(186, 190, 189)",
            z5g = "rgb(70, 74, 77)",
            r2u = "rgb(39, 92, 136)",
            xb3 = "rgb(56, 63, 79)",
            r5r = "rgb(93, 29, 27)",
            m8n = "rgb(66, 64, 51)",
            tcm = "rgb(16, 14, 19)",
            color = pkw;
        let color_1 = document.getElementById('color-1'),
            color_2 = document.getElementById('color-2'),
            color_3 = document.getElementById('color-3'),
            color_4 = document.getElementById('color-4'),
            color_5 = document.getElementById('color-5'),
            color_6 = document.getElementById('color-6'),
            color_7 = document.getElementById('color-7'),
            color_8 = document.getElementById('color-8'),
            color_9 = document.getElementById('color-9');
        // Scene settings      
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0xacacac);

        // The floor settings
        var floorGeometry = new THREE.PlaneGeometry(5000, 5000, 1, 1);
        var floorMaterial = new THREE.MeshPhongMaterial({
            color: 0x000000,
            shininess: 0.5
        });
        var floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.rotation.x = -0.5 * Math.PI;
        floor.receiveShadow = true;
        floor.position.y = -1;
        scene.add(floor);


        // Camera settings
        camera = new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,0.1,10000);
        camera.rotation.y = 45/180*Math.PI;
        camera.position.x = 800;
        camera.position.y = 100;
        camera.position.z = 1000;
        // Renderer settings
        renderer = new THREE.WebGLRenderer({antialias:true});
        renderer.setSize(window.innerWidth,window.innerHeight);
        document.body.appendChild(renderer.domElement);
        

        // light settings
        light = new THREE.PointLight(0xffffff,3);
        light.position.set(0,4000,500);
        scene.add(light);
        light = new THREE.PointLight(0xc4c4c4,3);
        light.position.set(300,-500,100);
        scene.add(light);
        light2 = new THREE.PointLight(0xc4c4c4,2);
        light2.position.set(-500,300,500);
        light.castShadow = true;
        scene.add(light2);
        var spotLight = new THREE.SpotLight( 0xffffff );
            spotLight.position.set( 500, 1000, 500 );
            spotLight.castShadow = true;
            spotLight.shadowMapWidth = 100;
            spotLight.shadowMapHeight = 100;
            scene.add( spotLight );



        // Loading car's model
        let loader = new THREE.GLTFLoader();
        loader.load('model/scene.gltf', function(gltf){
            car = gltf.scene.children[0];
            car.scale.set(2,2,2);
            scene.add(gltf.scene);
            animate();

        });

        // Loading car's color chagible model
        loader.load('model/color.gltf', function(gltf){
            car = gltf.scene.children[0];
            car.scale.set(2,2,2);
            scene.add(gltf.scene);
            animate();
            window.onload = function(){
                color = pkw;
            }
            let Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
            let Model = gltf.scene;
            Model.traverse((child, i) => {
                if (child.isMesh) {
                    child.material = Material;
                    child.material.side = THREE.DoubleSide;
                }
            });
            color_1.addEventListener('click', () => {
                color = pkw;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_2.addEventListener('click', () => {
                color = tw3;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_3.addEventListener('click', () => {
                color = u5s;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_4.addEventListener('click', () => {
                color = z5g;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_5.addEventListener('click', () => {
                color = r2u;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_6.addEventListener('click', () => {
                color = xb3;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_7.addEventListener('click', () => {
                color = r5r;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_8.addEventListener('click', () => {
                color = m8n;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                    if (child.isMesh) {
                        child.material = Material;
                        child.material.side = THREE.DoubleSide;
                    }
                });
            });
            color_9.addEventListener('click', () => {
                color = tcm;
                Material = new THREE.MeshStandardMaterial({ color: (color), roughness: 0.2, metalness: 0.8 });
                Model = gltf.scene;
                Model.traverse((child, i) => {
                  if (child.isMesh) {
                    child.material = Material;
                    child.material.side = THREE.DoubleSide;
                  }
                });
            });
            scene.add(Model);
        });

        // 360 rotating rendering settings
        let controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.addEventListener('change', renderer);
        function animate() {
            renderer.render(scene,camera);
            requestAnimationFrame(animate);
        }


        // Helpers
        // scene.add(new THREE.AxesHelper(5000));


        animate();


        
    </script>
</body>
</html>